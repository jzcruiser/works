<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">

<head>
  <meta name="Excel Workbook Frameset">
  <meta http-equiv=Content-Type content="text/html; charset=utf-8">
  <meta name=ProgId content=Excel.Sheet>
  <meta name=Generator content="Microsoft Excel 15">
  <script type="text/javascript" src="https://www.cnzoom.com/statics/js/jquery.min.js"></script>
</head>
<style>
  a {
    text-decoration: none;
    color: #333;
  }

  a:hover {
    text-decoration: none;
  }
</style>

<table border="0" cellpadding="0" cellspacing="0" width="875" style="border-collapse:
  collapse;table-layout:fixed;width:1200pt">
  <tbody>
    <tr height="34" style="height:25.7pt">
      <td height="34" class="xl65" width="175" style="height:25.7pt;width:131pt">买家ID</td>
      <td class="xl65" width="175" style="width:131pt">到期时间</td>
      <td class="xl65" width="250" style="width:200pt">模板名称
        <span style="mso-spacerun:yes">&nbsp;</span>
      </td>
      <td class="xl65" width="175" style="width:131pt">模板类型</td>
      <td class="xl65" width="175" style="width:131pt">产品ID</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">aalisonn</td>
      <td>2022-07-20</td>
      <td>家具家居建材灯饰卫浴厨卫定
        <span style="display:none">制极简全屏沃姆无线</span>
      </td>
      <td>无线</td>
      <td>376</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">titianlashes</td>
      <td>2022-01-19</td>
      <td>简约大气眼镜太阳镜功能镜配
        <span style="display:none">件挂饰沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>5728</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">titianlashes</td>
      <td>2022-01-19</td>
      <td>简约大气眼镜太阳镜功能镜配
        <span style="display:none">件挂饰全屏沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4790</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">sdmjk</td>
      <td>2022-07-19</td>
      <td>工业电器空调冰箱洗衣机电风
        <span style="display:none">扇节能电器沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>5607</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">gzbeiluo</td>
      <td>2022-07-19</td>
      <td>外贸欧美简约男装女装服装辅
        <span style="display:none">料全屏效果沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>337</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">mingguan888</td>
      <td>2022-07-19</td>
      <td>奖章奖牌奖杯铜牌钥匙扣徽章
        <span style="display:none">胸章沃姆无线</span>
      </td>
      <td>无线</td>
      <td>5242</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">mingguan888</td>
      <td>2022-07-19</td>
      <td>奖章奖牌奖杯铜牌钥匙扣徽章
        <span style="display:none">胸章全屏沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4557</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">caitech</td>
      <td>2021-08-17</td>
      <td>简约大气数码家电耳机音响周
        <span style="display:none">边电子沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>5409</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">zhenyanghardware</td>
      <td>2021-10-24</td>
      <td>阀门工具五金配件球阀蝶阀沃
        <span style="display:none">姆设计无线</span>
      </td>
      <td>无线</td>
      <td>7648</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">zhenyanghardware</td>
      <td>2021-10-24</td>
      <td>阀门工具五金配件球阀蝶阀沃
        <span style="display:none">姆设计PC</span>
      </td>
      <td>PC</td>
      <td>7450</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">hongye888</td>
      <td>2022-07-17</td>
      <td>餐具不锈钢五金刀具剪刀不锈
        <span style="display:none">钢炊具全屏沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4620</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">hongye888</td>
      <td>2022-07-17</td>
      <td>家具家居建材灯饰卫浴厨卫极
        <span style="display:none">简全屏沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>2016</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">jiuxing1</td>
      <td>2022-08-16</td>
      <td>简约大气眼镜太阳镜功能镜配
        <span style="display:none">件挂饰沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>5728</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">jiuxing1</td>
      <td>2022-08-16</td>
      <td>简约大气眼镜太阳镜功能镜配
        <span style="display:none">件挂饰全屏沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4790</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">jiuxing1</td>
      <td>2022-07-23</td>
      <td>简约大气眼镜太阳镜功能镜配
        <span style="display:none">件挂饰全屏沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4790</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">ricbeauty</td>
      <td>2021-07-29</td>
      <td>美容护肤化妆工具化妆品面膜
        <span style="display:none">美发沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>7682</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">jiuxing1</td>
      <td>2022-07-25</td>
      <td>简约大气眼镜太阳镜功能镜配
        <span style="display:none">件挂饰沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>5728</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">cn1516673943dzmo</td>
      <td>2021-07-22</td>
      <td>产品包装标签印刷纸盒购物袋
        <span style="display:none">服装吊牌沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>7984</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">cn1516673943dzmo</td>
      <td>2021-07-21</td>
      <td>产品包装标签印刷纸盒购物袋
        <span style="display:none">服装吊牌沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>7555</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">szsonghuan</td>
      <td>2021-07-15</td>
      <td>简约大气数码家电耳机音响周
        <span style="display:none">边电子沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>5409</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">sunriseseast</td>
      <td>2021-06-15</td>
      <td>瓷器餐具马克杯西餐具搪瓷西
        <span style="display:none">餐盘沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4746</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">cn1524764181mhvb</td>
      <td>2022-07-15</td>
      <td>机械零件模具传感器轴承重工
        <span style="display:none">业机床配件沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>7680</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">zonq</td>
      <td>2021-05-15</td>
      <td>简约大气数码家电耳机音响周
        <span style="display:none">边电子沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>5409</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">cn1524764181mhvb</td>
      <td>2022-04-15</td>
      <td>机械零件模具传感器轴承重工
        <span style="display:none">业机床配件沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>7488</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">szeyesky</td>
      <td>2021-03-14</td>
      <td>工业电器空调冰箱洗衣机电风
        <span style="display:none">扇节能电器沃姆设计无线</span>
      </td>
      <td>无线</td>
      <td>5849</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">tecshine</td>
      <td>2021-02-14</td>
      <td>包装盒礼盒纸杯购物袋标签沃
        <span style="display:none">姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4725</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">yiosi</td>
      <td>2021-01-14</td>
      <td>家具家居建材灯饰卫浴厨卫定
        <span style="display:none">制极简全屏沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>375</td>
    </tr>
    <tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt">jiuxing1</td>
      <td>2021-07-23</td>
      <td>简约大气眼镜太阳镜功能镜配
        <span style="display:none">件挂饰全屏沃姆设计PC</span>
      </td>
      <td>PC</td>
      <td>4790</td>
    </tr>
  </tbody>
</table>
<script>
  $(function () {
    //格式化时间
    Date.prototype.format = function (format) {
      let o = {
        "M+": this.getMonth() + 1, //month
        "d+": this.getDate(), //day
        "h+": this.getHours(), //hour
        "m+": this.getMinutes(), //minute
        "s+": this.getSeconds(), //second
        "q+": Math.floor((this.getMonth() + 3) / 3), //quarter
        "S": this.getMilliseconds() //millisecond
      }
      if (/(y+)/.test(format)) format = format.replace(RegExp.$1,
        (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      for (let k in o) if (new RegExp("(" + k + ")").test(format))
        format = format.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length));
      return format;
    };
    //去重
    function RemoveArr(arr) {
      for (let i = 0; i < arr.length; i++) {
        for (let j = i + 1; j < arr.length;) {
          if (arr[i].userNick == arr[j].userNick && arr[i].productId == arr[j].productId && arr[i].type == arr[j].type) {
            arr.splice(j, 1)
          } else {
            j++
          }
        }
      }
      return arr
    }

    //排序
    function sortBy(filed, rev, primer) {
      rev = (rev) ? -1 : 1;
      return function (a, b) {
        a = a[filed];
        b = b[filed];
        if (primer && typeof (primer) != 'undefined') {
          a = primer(a);
          b = primer(b);
        } else {
          if (!isNaN(a) && !isNaN(a)) {
            a = Number(a);
            b = Number(b);
          }
        }
        if (a < b) { return rev * -1; }
        if (a > b) { return rev * 1; }
        return 1;
      }
    };
    //生成HTML
    function getHtml(arr) {
      return arr.map((item, index) =>
        `<tr height="34" style="height:25.7pt">
      <td height="34" style="height:25.7pt"><a target="_blank" href='https://amos.alicdn.com/msg.aw?spm=a278v.11288064.0.0.2c39337662NCGo&v=2&uid=${item.userNick}&site=enaliint&s=24&charset=UTF-8'>${item.userNick}</a></td>
      <td>${item.endTime}</td>
      <td><a target="_blank" href='https://zhuangxiu.alibaba.com/detail.html?code=izx_${item.productId}'>${item.productName}</a></td>
      <td>${item.type}</td>
      <td>${item.productId}</td>
    </tr>`
      )
    }

    // 1、去重，去掉重复部分（买家ID、模板名字相同的，只保留最后一次订购数据）2.排序自动改为按到期时间由近到远排序
    let contentArr = [];
    for (let i = 0; i < $('table tr').length; i++) {
      if (i > 0) {
        contentArr.push({
          "userNick": $('table tr td:nth-child(1)')[i].innerText,
          "endTime": $('table tr td:nth-child(2)')[i].innerText,
          "productName": $('table tr td:nth-child(3)')[i].innerText,
          "type": $('table tr td:nth-child(4)')[i].innerText,
          "productId": $('table tr td:nth-child(5)')[i].innerText
        });
      }
    }
    RemoveArr(contentArr)
    contentArr.sort(sortBy('endTime', false));
    let date = new Date();
    let todayFormat = date.format('yyyy-MM-dd');
    let oldArr = [];
    let newArr = [];
    contentArr.map((item, index) => {
      if (item.endTime > todayFormat) {
        newArr.push(item);
      } else {
        oldArr.push(item);
      }
    })
    let tableHtml = `<tr height="34" style="height:25.7pt">
      <td height="34" class="xl65" width="175" style="height:25.7pt;width:131pt">买家ID</td>
      <td class="xl65" width="175" style="width:131pt">到期时间</td>
      <td class="xl65" width="250" style="width:200pt">模板名称</td>
      <td class="xl65" width="175" style="width:131pt">模板类型</td>
      <td class="xl65" width="175" style="width:131pt">产品ID0</td>
    </tr>`;
    let newList = getHtml(newArr);
    tableHtml += newList.join("") + `<tr><td colspan="5"><hr></td></tr>`;
    let oldList = getHtml(oldArr.sort(sortBy('endTime', true)));
    tableHtml += oldList.join("");
    $("tbody").empty().html(tableHtml);
  });

</script>

</html>